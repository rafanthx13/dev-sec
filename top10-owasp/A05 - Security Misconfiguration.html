<!DOCTYPE html>
<html>
<head>
<title>A05 - Security Misconfiguration.md</title>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8">

<style>
/* https://github.com/microsoft/vscode/blob/master/extensions/markdown-language-features/media/markdown.css */
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

body {
	font-family: var(--vscode-markdown-font-family, -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif);
	font-size: var(--vscode-markdown-font-size, 14px);
	padding: 0 26px;
	line-height: var(--vscode-markdown-line-height, 22px);
	word-wrap: break-word;
}

#code-csp-warning {
	position: fixed;
	top: 0;
	right: 0;
	color: white;
	margin: 16px;
	text-align: center;
	font-size: 12px;
	font-family: sans-serif;
	background-color:#444444;
	cursor: pointer;
	padding: 6px;
	box-shadow: 1px 1px 1px rgba(0,0,0,.25);
}

#code-csp-warning:hover {
	text-decoration: none;
	background-color:#007acc;
	box-shadow: 2px 2px 2px rgba(0,0,0,.25);
}

body.scrollBeyondLastLine {
	margin-bottom: calc(100vh - 22px);
}

body.showEditorSelection .code-line {
	position: relative;
}

body.showEditorSelection .code-active-line:before,
body.showEditorSelection .code-line:hover:before {
	content: "";
	display: block;
	position: absolute;
	top: 0;
	left: -12px;
	height: 100%;
}

body.showEditorSelection li.code-active-line:before,
body.showEditorSelection li.code-line:hover:before {
	left: -30px;
}

.vscode-light.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(0, 0, 0, 0.15);
}

.vscode-light.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(0, 0, 0, 0.40);
}

.vscode-light.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-dark.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 255, 255, 0.4);
}

.vscode-dark.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 255, 255, 0.60);
}

.vscode-dark.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-high-contrast.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 160, 0, 0.7);
}

.vscode-high-contrast.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 160, 0, 1);
}

.vscode-high-contrast.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

img {
	max-width: 100%;
	max-height: 100%;
}

a {
	text-decoration: none;
}

a:hover {
	text-decoration: underline;
}

a:focus,
input:focus,
select:focus,
textarea:focus {
	outline: 1px solid -webkit-focus-ring-color;
	outline-offset: -1px;
}

hr {
	border: 0;
	height: 2px;
	border-bottom: 2px solid;
}

h1 {
	padding-bottom: 0.3em;
	line-height: 1.2;
	border-bottom-width: 1px;
	border-bottom-style: solid;
}

h1, h2, h3 {
	font-weight: normal;
}

table {
	border-collapse: collapse;
}

table > thead > tr > th {
	text-align: left;
	border-bottom: 1px solid;
}

table > thead > tr > th,
table > thead > tr > td,
table > tbody > tr > th,
table > tbody > tr > td {
	padding: 5px 10px;
}

table > tbody > tr + tr > td {
	border-top: 1px solid;
}

blockquote {
	margin: 0 7px 0 5px;
	padding: 0 16px 0 10px;
	border-left-width: 5px;
	border-left-style: solid;
}

code {
	font-family: Menlo, Monaco, Consolas, "Droid Sans Mono", "Courier New", monospace, "Droid Sans Fallback";
	font-size: 1em;
	line-height: 1.357em;
}

body.wordWrap pre {
	white-space: pre-wrap;
}

pre:not(.hljs),
pre.hljs code > div {
	padding: 16px;
	border-radius: 3px;
	overflow: auto;
}

pre code {
	color: var(--vscode-editor-foreground);
	tab-size: 4;
}

/** Theming */

.vscode-light pre {
	background-color: rgba(220, 220, 220, 0.4);
}

.vscode-dark pre {
	background-color: rgba(10, 10, 10, 0.4);
}

.vscode-high-contrast pre {
	background-color: rgb(0, 0, 0);
}

.vscode-high-contrast h1 {
	border-color: rgb(0, 0, 0);
}

.vscode-light table > thead > tr > th {
	border-color: rgba(0, 0, 0, 0.69);
}

.vscode-dark table > thead > tr > th {
	border-color: rgba(255, 255, 255, 0.69);
}

.vscode-light h1,
.vscode-light hr,
.vscode-light table > tbody > tr + tr > td {
	border-color: rgba(0, 0, 0, 0.18);
}

.vscode-dark h1,
.vscode-dark hr,
.vscode-dark table > tbody > tr + tr > td {
	border-color: rgba(255, 255, 255, 0.18);
}

</style>

<style>
/* Tomorrow Theme */
/* http://jmblog.github.com/color-themes-for-google-code-highlightjs */
/* Original theme - https://github.com/chriskempson/tomorrow-theme */

/* Tomorrow Comment */
.hljs-comment,
.hljs-quote {
	color: #8e908c;
}

/* Tomorrow Red */
.hljs-variable,
.hljs-template-variable,
.hljs-tag,
.hljs-name,
.hljs-selector-id,
.hljs-selector-class,
.hljs-regexp,
.hljs-deletion {
	color: #c82829;
}

/* Tomorrow Orange */
.hljs-number,
.hljs-built_in,
.hljs-builtin-name,
.hljs-literal,
.hljs-type,
.hljs-params,
.hljs-meta,
.hljs-link {
	color: #f5871f;
}

/* Tomorrow Yellow */
.hljs-attribute {
	color: #eab700;
}

/* Tomorrow Green */
.hljs-string,
.hljs-symbol,
.hljs-bullet,
.hljs-addition {
	color: #718c00;
}

/* Tomorrow Blue */
.hljs-title,
.hljs-section {
	color: #4271ae;
}

/* Tomorrow Purple */
.hljs-keyword,
.hljs-selector-tag {
	color: #8959a8;
}

.hljs {
	display: block;
	overflow-x: auto;
	color: #4d4d4c;
	padding: 0.5em;
}

.hljs-emphasis {
	font-style: italic;
}

.hljs-strong {
	font-weight: bold;
}
</style>

<style>
/*
 * Markdown PDF CSS
 */

 body {
	font-family: -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif, "Meiryo";
	padding: 0 12px;
}

pre {
	background-color: #f8f8f8;
	border: 1px solid #cccccc;
	border-radius: 3px;
	overflow-x: auto;
	white-space: pre-wrap;
	overflow-wrap: break-word;
}

pre:not(.hljs) {
	padding: 23px;
	line-height: 19px;
}

blockquote {
	background: rgba(127, 127, 127, 0.1);
	border-color: rgba(0, 122, 204, 0.5);
}

.emoji {
	height: 1.4em;
}

code {
	font-size: 14px;
	line-height: 19px;
}

/* for inline code */
:not(pre):not(.hljs) > code {
	color: #C9AE75; /* Change the old color so it seems less like an error */
	font-size: inherit;
}

/* Page Break : use <div class="page"/> to insert page break
-------------------------------------------------------- */
.page {
	page-break-after: always;
}

</style>

<script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
</head>
<body>
  <script>
    mermaid.initialize({
      startOnLoad: true,
      theme: document.body.classList.contains('vscode-dark') || document.body.classList.contains('vscode-high-contrast')
          ? 'dark'
          : 'default'
    });
  </script>
<h1 id="a05---security-misconfiguration">A05 - Security Misconfiguration</h1>
<h2 id="resumo">Resumo</h2>
<p>São questões de configurações default, ou sem restrição o que msotrma demais (como explodir o stack trace); CORS, Servidor, Permisses e Headers mal configurados; Coisa de desenvolvimento e produçao; ativado o ambient de debug em produçao</p>
<h2 id="links">Links</h2>
<ul>
<li>https://owasp.org/Top10/pt_BR/A05_2021-Security_Misconfiguration/</li>
</ul>
<p>--==========================================================
--==========================================================
--==========================================================
--==========================================================
--==========================================================</p>
<h2 id="owasp">OWASP</h2>
<h2 id="descri%C3%A7%C3%A3o">Descrição</h2>
<p>A aplicação pode ser vulnerável se for:</p>
<ul>
<li>
<p>Falta de proteção de segurança apropriada em qualquer parte da  <em>stack</em>  das aplicações ou permissões configuradas incorretamente em serviços em nuvem.</p>
</li>
<li>
<p>Recursos desnecessários são ativados ou instalados (por exemplo, portas, serviços, páginas, contas ou privilégios desnecessários).</p>
</li>
<li>
<p>As contas padrão e suas senhas ainda estão ativadas e inalteradas.</p>
</li>
<li>
<p>O tratamento de erros revela  <em>stack traces</em>  ou outras mensagens de erro excessivamente informativas aos usuários.</p>
</li>
<li>
<p>Para sistemas atualizados, os recursos de segurança mais recentes estão desabilitados ou não estão configurados com segurança.</p>
</li>
<li>
<p>As configurações de segurança nos servidores das aplicações, nos  <em>frameworks</em>  (por exemplo, Struts, Spring, ASP.NET), bibliotecas, bancos de dados, etc., não estão definidas para proteger os valores.</p>
</li>
<li>
<p>O servidor não envia cabeçalhos ou diretivas de segurança, ou eles não estão configurados para proteger os valores.</p>
</li>
<li>
<p>O software está desatualizado ou vulnerável (consulte  <a href="https://owasp.org/Top10/pt_BR/A06_2021-Vulnerable_and_Outdated_Components/">A06: 2021-Componentes Vulneráveis e Desatualizados</a>).</p>
</li>
</ul>
<p>Sem um processo de configuração de segurança de aplicações que seja integrado e repetível, os sistemas correm um risco maior.</p>
<h2 id="como-prevenir">Como Prevenir</h2>
<p>Devem ser implementados processos de instalação segura, incluindo:</p>
<ul>
<li>
<p>Um processo de proteção repetível torna mais rápido e fácil implantar outro ambiente que esteja devidamente bloqueado. Os ambientes de desenvolvimento, controle de qualidade e produção devem ser todos configurados de forma idêntica, com credenciais diferentes usadas em cada ambiente. Este processo deve ser automatizado para minimizar o esforço necessário para configurar um novo ambiente seguro.</p>
</li>
<li>
<p>Uma plataforma mínima sem recursos, componentes, documentação e outros desnecessários. Remova ou não instale recursos e estruturas não utilizados.</p>
<ul>
<li>Uma tarefa para revisar e atualizar as configurações apropriadas para todas as notas de segurança, atualizações e patches como parte do processo de gerenciamento de patch (consulte  <a href="https://owasp.org/Top10/pt_BR/A06_2021-Vulnerable_and_Outdated_Components/">A06: 2021-Componentes Vulneráveis e Desatualizados</a>). Revise as permissões de armazenamento em nuvem (por exemplo,  <em>S3 bucket permissions</em>).</li>
</ul>
</li>
<li>
<p>Uma arquitetura de aplicação segmentada fornece separação eficaz e segura entre componentes ou  <em>tenants</em>, com segmentação, conteinerização ou grupos de segurança em nuvem (ACLs).</p>
</li>
<li>
<p>Envio de diretivas de segurança para clientes, por exemplo,  <em>Security Headers</em>.</p>
</li>
<li>
<p>Um processo automatizado para verificar a eficácia das configurações em todos os ambientes.</p>
</li>
</ul>
<h2 id="exemplos-de-cen%C3%A1rios-de-ataque">Exemplos de Cenários de Ataque</h2>
<p><strong>Cenário #1:</strong>  O servidor da aplicação é fornecido com os sistemas de amostra não removidos do servidor de produção. Esses aplicativos de amostra têm falhas de segurança conhecidas que os invasores usam para comprometer o servidor. Suponha que um desses aplicativos seja o console de administração e as contas padrão não tenham sido alteradas. Nesse caso, o invasor efetua login com as senhas padrão e assume o controle.</p>
<p><strong>Cenário #2:</strong>  A listagem do diretório não está desabilitada no servidor. Um invasor descobre que pode simplesmente listar diretórios. O invasor encontra e baixa as classes Java compiladas, que ele descompila e faz engenharia reversa para visualizar o código. O invasor então encontra uma falha grave de controle de acesso no aplicativo.</p>
<p><strong>Cenário #3:</strong>  A configuração do servidor de aplicações permite que os detalhes das mensagens de erro, por exemplo,  <em>stack trace</em>, sejam retornadas aos usuários. Isso potencialmente expõe informações confidenciais ou falhas subjacentes, como versões de componentes que são conhecidas por serem vulneráveis.</p>
<p><strong>Cenário #4:</strong>  Um provedor de serviços de nuvem tem permissões de compartilhamento padrão abertas para a Internet por outros usuários de  <em>Content Security Policy header (CSP)</em>. Isso permite que dados confidenciais armazenados no armazenamento em nuvem sejam acessados.</p>
<h2 id="refer%C3%AAncias">Referências</h2>
<ul>
<li>
<p><a href="https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/02-Configuration_and_Deployment_Management_Testing/README">OWASP Testing Guide: Configuration Management</a></p>
</li>
<li>
<p><a href="https://owasp.org/www-project-web-security-testing-guide/stable/4-Web_Application_Security_Testing/08-Testing_for_Error_Handling/01-Testing_For_Improper_Error_Handling">OWASP Testing Guide: Testing for Error Codes</a></p>
</li>
<li>
<p>Application Security Verification Standard V19 Configuration</p>
</li>
<li>
<p><a href="https://csrc.nist.gov/publications/detail/sp/800-123/final">NIST Guide to General Server Hardening</a></p>
</li>
<li>
<p><a href="https://www.cisecurity.org/cis-benchmarks/">CIS Security Configuration Guides/Benchmarks</a></p>
</li>
<li>
<p><a href="https://blog.websecurify.com/2017/10/aws-s3-bucket-discovery.html">Amazon S3 Bucket Discovery and Enumeration</a></p>
</li>
</ul>
<h2 id="lista-dos-cwes-mapeados">Lista dos CWEs Mapeados</h2>
<p><a href="https://cwe.mitre.org/data/definitions/2.html">CWE-2 7PK - Environment</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/11.html">CWE-11 ASP.NET Misconfiguration: Creating Debug Binary</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/13.html">CWE-13 ASP.NET Misconfiguration: Password in Configuration File</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/15.html">CWE-15 External Control of System or Configuration Setting</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/16.html">CWE-16 Configuration</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/260.html">CWE-260 Password in Configuration File</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/315.html">CWE-315 Cleartext Storage of Sensitive Information in a Cookie</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/520.html">CWE-520 .NET Misconfiguration: Use of Impersonation</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/526.html">CWE-526 Exposure of Sensitive Information Through Environmental Variables</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/537.html">CWE-537 Java Runtime Error Message Containing Sensitive Information</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/541.html">CWE-541 Inclusion of Sensitive Information in an Include File</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/547.html">CWE-547 Use of Hard-coded, Security-relevant Constants</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/611.html">CWE-611 Improper Restriction of XML External Entity Reference</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/614.html">CWE-614 Sensitive Cookie in HTTPS Session Without 'Secure' Attribute</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/756.html">CWE-756 Missing Custom Error Page</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/776.html">CWE-776 Improper Restriction of Recursive Entity References in DTDs ('XML Entity Expansion')</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/942.html">CWE-942 Permissive Cross-domain Policy with Untrusted Domains</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/1004.html">CWE-1004 Sensitive Cookie Without 'HttpOnly' Flag</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/1032.html">CWE-1032 OWASP Top Ten 2017 Category A6 - Security Misconfiguration</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/1174.html">CWE-1174 ASP.NET Misconfiguration: Improper Model Validation</a></p>
<p>--==========================================================
--==========================================================
--==========================================================
--==========================================================
--==========================================================
--==========================================================
--==========================================================</p>
<h2 id="chatpgt">Chatpgt</h2>
<h3 id="q1---chatpgt---o-que-%C3%A9-a05">Q1 - CHATPGT - O que é A05</h3>
<blockquote>
<p>Fale sobre A05 Security Misconfiguration do OWASP</p>
</blockquote>
<p>Claro! A <strong>A05:2021 - Security Misconfiguration</strong> (ou <strong>&quot;Configuração de Segurança Incorreta&quot;</strong>) é uma das vulnerabilidades mais comuns e perigosas listadas pelo <strong>OWASP Top 10</strong>, e afeta tanto aplicações simples quanto sistemas corporativos complexos.</p>
<hr>
<h2 id="%F0%9F%94%90-o-que-%C3%A9-a-a05---security-misconfiguration">🔐 O que é a A05 - Security Misconfiguration?</h2>
<p>É quando uma aplicação, servidor, banco de dados ou serviço <strong>está configurado de forma insegura</strong>, seja por padrão fraco, falta de restrições ou configurações incorretas/omitidas. Isso pode abrir brechas graves para invasores.</p>
<hr>
<h2 id="%E2%9A%A0%EF%B8%8F-exemplos-t%C3%ADpicos">⚠️ Exemplos típicos</h2>
<table>
<thead>
<tr>
<th>Situação</th>
<th>Impacto</th>
</tr>
</thead>
<tbody>
<tr>
<td>Servidor web exibindo mensagens de erro detalhadas</td>
<td>Exposição de stack trace e estruturas internas</td>
</tr>
<tr>
<td>Console de administração sem autenticação ou exposto na internet</td>
<td>Controle total do sistema</td>
</tr>
<tr>
<td>CORS mal configurado</td>
<td>Permite requisições indevidas de domínios não autorizados</td>
</tr>
<tr>
<td>Headers de segurança ausentes (como <code>X-Content-Type-Options</code>, <code>Content-Security-Policy</code>)</td>
<td>Facilita ataques como XSS, clickjacking</td>
</tr>
<tr>
<td>Permissões excessivas em arquivos ou diretórios</td>
<td>Vazamento ou alteração de arquivos sensíveis</td>
</tr>
<tr>
<td>Ambiente de desenvolvimento ativo em produção</td>
<td>Pode incluir debug aberto, senhas hardcoded, verbose logging</td>
</tr>
<tr>
<td>Configuração padrão de banco de dados (usuário &quot;root&quot;, sem senha)</td>
<td>Acesso total não controlado</td>
</tr>
</tbody>
</table>
<hr>
<h2 id="%F0%9F%8E%AF-como-ela-se-relaciona-com-boas-pr%C3%A1ticas-de-desenvolvimento-seguro">🎯 Como ela se relaciona com <strong>boas práticas de desenvolvimento seguro</strong></h2>
<p>A A05 acontece, em geral, quando:</p>
<ul>
<li>A equipe esquece de revisar as configurações padrão (do servidor, app ou dependência).</li>
<li>Há falta de consistência entre <strong>ambientes de dev, staging e produção</strong>.</li>
<li>Não há processos de <strong>hardening (reforço de segurança)</strong> e <strong>automatização</strong> de configurações seguras.</li>
</ul>
<hr>
<h2 id="%F0%9F%9B%A1%EF%B8%8F-como-se-proteger">🛡️ Como se proteger</h2>
<h3 id="1-desabilite-o-que-n%C3%A3o-usa">1. <strong>Desabilite o que não usa</strong></h3>
<ul>
<li>Remova consoles, endpoints de debug, permissões de arquivos, usuários padrão.</li>
</ul>
<h3 id="2-revise-as-configura%C3%A7%C3%B5es-de-seguran%C3%A7a">2. <strong>Revise as configurações de segurança</strong></h3>
<ul>
<li>Cheque CORS, headers HTTP, autenticação, permissões de acesso.</li>
</ul>
<h3 id="3-automatize-e-padronize">3. <strong>Automatize e padronize</strong></h3>
<ul>
<li>Use ferramentas como <strong>Ansible</strong>, <strong>Terraform</strong>, <strong>Dockerfile hardening</strong> e <strong>CI/CD pipelines</strong> com políticas seguras.</li>
</ul>
<h3 id="4-configure-o-ambiente-corretamente">4. <strong>Configure o ambiente corretamente</strong></h3>
<ul>
<li>Separe credenciais, desative debug em produção, restrinja portas/serviços, use HTTPS sempre.</li>
</ul>
<h3 id="5-use-scanners-de-seguran%C3%A7a">5. <strong>Use scanners de segurança</strong></h3>
<ul>
<li>Ferramentas como <strong>OWASP ZAP</strong>, <strong>Nikto</strong>, <strong>Nmap</strong>, <strong>SSL Labs</strong>, <strong>Mozilla Observatory</strong> podem detectar falhas de configuração.</li>
</ul>
<hr>
<h2 id="%F0%9F%93%8C-exemplo-pr%C3%A1tico-laravel">📌 Exemplo prático (Laravel)</h2>
<h3 id="erro">Erro:</h3>
<p><code>APP_DEBUG=true</code> no <code>.env</code> em produção</p>
<h3 id="risco">Risco:</h3>
<p>Mostra detalhes de exceções, paths, queries e até senhas em erro de conexão.</p>
<h3 id="correto">Correto:</h3>
<pre class="hljs"><code><div>APP_DEBUG=false
APP_ENV=production
</div></code></pre>
<hr>
<p>Se quiser, posso revisar com você algumas configurações de segurança em um projeto Laravel seu, ou mostrar como usar scanners como o ZAP para encontrar essas falhas. Deseja?</p>
<h3 id="q2---exemplos-disos-em-php-e-laravel">Q2 - Exemplos disos em php e laravel</h3>
<blockquote>
<p>De exemplo disos no php puro, e no laravel</p>
</blockquote>
<p>Claro, Rafael! Vamos ver <strong>exemplos práticos da A05 - Security Misconfiguration</strong> tanto em <strong>PHP puro</strong> quanto em <strong>Laravel</strong>, para entender como essas falhas aparecem e como evitá-las.</p>
<hr>
<h2 id="%F0%9F%94%B8-php-puro--exemplos-de-misconfigura%C3%A7%C3%A3o-de-seguran%C3%A7a">🔸 PHP PURO — Exemplos de <strong>misconfiguração de segurança</strong></h2>
<h3 id="%E2%9D%8C-1-exibi%C3%A7%C3%A3o-de-erros-em-produ%C3%A7%C3%A3o">❌ <strong>1. Exibição de erros em produção</strong></h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Em produção</span>
ini_set(<span class="hljs-string">'display_errors'</span>, <span class="hljs-number">1</span>);
error_reporting(E_ALL);
</div></code></pre>
<p>➡️ Isso mostra detalhes de falhas ao usuário final, como paths e queries.</p>
<p>✅ <strong>Correção:</strong></p>
<pre class="hljs"><code><div><span class="hljs-comment">// Em produção</span>
ini_set(<span class="hljs-string">'display_errors'</span>, <span class="hljs-number">0</span>);
error_reporting(<span class="hljs-number">0</span>);
<span class="hljs-comment">// E registrar em log seguro</span>
ini_set(<span class="hljs-string">'log_errors'</span>, <span class="hljs-number">1</span>);
ini_set(<span class="hljs-string">'error_log'</span>, <span class="hljs-string">'/var/log/php_errors.log'</span>);
</div></code></pre>
<hr>
<h3 id="%E2%9D%8C-2-diret%C3%B3rio-com-permiss%C3%B5es-erradas">❌ <strong>2. Diretório com permissões erradas</strong></h3>
<pre class="hljs"><code><div>chmod -R 777 /var/www/html/
</div></code></pre>
<p>➡️ Qualquer processo pode modificar arquivos da aplicação. Risco grave!</p>
<p>✅ <strong>Correção:</strong></p>
<pre class="hljs"><code><div>chmod -R 755 /var/www/html/
chown -R www-data:www-data /var/www/html/
</div></code></pre>
<hr>
<h3 id="%E2%9D%8C-3-arquivo-de-configura%C3%A7%C3%A3o-exposto">❌ <strong>3. Arquivo de configuração exposto</strong></h3>
<pre class="hljs"><code><div><span class="hljs-comment"># Exemplo: acesso público ao .env, .ini ou config.php</span>
http://example.com/config.php
</div></code></pre>
<p>➡️ Permite acesso a senhas, tokens e configurações sensíveis.</p>
<p>✅ <strong>Correção:</strong></p>
<ul>
<li>Mover arquivos confidenciais para fora do <code>public_html</code>.</li>
<li>Usar <code>.htaccess</code> para bloquear acesso:</li>
</ul>
<pre class="hljs"><code><div><span class="hljs-section">&lt;Files .env&gt;</span>
    <span class="hljs-attribute"><span class="hljs-nomarkup">Order</span></span> allow,deny
    <span class="hljs-attribute"><span class="hljs-nomarkup">Deny</span></span> from <span class="hljs-literal">all</span>
<span class="hljs-section">&lt;/Files&gt;</span>
</div></code></pre>
<hr>
<h2 id="%F0%9F%94%B9-laravel--exemplos-de-security-misconfiguration">🔹 LARAVEL — Exemplos de <strong>Security Misconfiguration</strong></h2>
<h3 id="%E2%9D%8C-1-appdebugtrue-em-produ%C3%A7%C3%A3o">❌ <strong>1. <code>APP_DEBUG=true</code> em produção</strong></h3>
<pre class="hljs"><code><div>APP_DEBUG=true
</div></code></pre>
<p>➡️ Mostra stack traces completos, incluindo variáveis de ambiente e SQLs.</p>
<p>✅ <strong>Correção:</strong></p>
<pre class="hljs"><code><div>APP_DEBUG=false
APP_ENV=production
</div></code></pre>
<hr>
<h3 id="%E2%9D%8C-2-falta-de-headers-de-seguran%C3%A7a">❌ <strong>2. Falta de headers de segurança</strong></h3>
<p>Laravel, por padrão, não inclui todos os headers de segurança recomendados.</p>
<p>✅ <strong>Correção:</strong>
Use o middleware do pacote <a href="https://github.com/spatie/laravel-csp"><code>spatie/laravel-csp</code></a> ou adicione manualmente:</p>
<pre class="hljs"><code><div><span class="hljs-comment">// app/Http/Middleware/SecurityHeaders.php</span>
<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">handle</span><span class="hljs-params">($request, Closure $next)</span>
</span>{
    $response = $next($request);
    $response-&gt;headers-&gt;set(<span class="hljs-string">'X-Frame-Options'</span>, <span class="hljs-string">'DENY'</span>);
    $response-&gt;headers-&gt;set(<span class="hljs-string">'X-Content-Type-Options'</span>, <span class="hljs-string">'nosniff'</span>);
    $response-&gt;headers-&gt;set(<span class="hljs-string">'Referrer-Policy'</span>, <span class="hljs-string">'no-referrer'</span>);
    $response-&gt;headers-&gt;set(<span class="hljs-string">'Content-Security-Policy'</span>, <span class="hljs-string">"default-src 'self'"</span>);
    <span class="hljs-keyword">return</span> $response;
}
</div></code></pre>
<hr>
<h3 id="%E2%9D%8C-3-expor-rotas-sens%C3%ADveis-no-webphp">❌ <strong>3. Expor rotas sensíveis no <code>web.php</code></strong></h3>
<pre class="hljs"><code><div>Route::get(<span class="hljs-string">'/telescope'</span>); <span class="hljs-comment">// ou /horizon sem proteção</span>
</div></code></pre>
<p>➡️ Se não estiver protegido com autenticação, expõe informações internas.</p>
<p>✅ <strong>Correção:</strong></p>
<pre class="hljs"><code><div>Route::middleware([<span class="hljs-string">'auth'</span>])-&gt;group(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
    \Laravel\Telescope\Telescope::auth(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">($request)</span> </span>{
        <span class="hljs-keyword">return</span> auth()-&gt;check() &amp;&amp; auth()-&gt;user()-&gt;is_admin;
    });
});
</div></code></pre>
<hr>
<h2 id="%E2%9C%85-dica-final">✅ Dica final</h2>
<p>A melhor forma de evitar a A05 é manter <strong>uma checklist de segurança para deploy</strong> com itens como:</p>
<ul>
<li><code>APP_DEBUG=false</code></li>
<li><code>.env</code> inacessível</li>
<li>permissões corretas</li>
<li>headers ativos</li>
<li>endpoints sensíveis autenticados</li>
</ul>
<hr>
<p>Quer que eu te ajude a criar um checklist de deploy seguro para PHP ou Laravel?</p>
<p>--==========================================================
--==========================================================
--==========================================================
--==========================================================
--==========================================================
--==========================================================
--==========================================================</p>
<h2 id="perplexity">Perplexity</h2>
<img src="https://r2cdn.perplexity.ai/pplx-full-logo-primary-dark%402x.png" class="logo" width="120"/>
<h1 id="a052021-configura%C3%A7%C3%A3o-incorreta-de-seguran%C3%A7a-da-owasp-top-10">A05:2021-Configuração Incorreta de Segurança da OWASP Top 10</h1>
<p>A categoria <strong>A05:2021-Configuração Incorreta de Segurança</strong> ocupa a 5ª posição no OWASP Top 10 2021, representando uma das vulnerabilidades mais críticas em aplicações web modernas. Caracterizada pela implementação inadequada de controles de segurança em componentes de software, infraestrutura ou serviços em nuvem, essa falha expõe sistemas a explorações que poderiam ser evitadas com configurações adequadas. Estudos indicam que <strong>90% das aplicações</strong> testadas apresentaram pelo menos uma forma de configuração insegura, com mais de 208 mil ocorrências documentadas de <em>Common Weakness Enumeration</em> (CWE) relacionadas a essa categoria<a href="https://repositorio.ufu.br/bitstream/123456789/38406/1/EstudoVulnerabilidadesOWASP.pdf">^1</a>.</p>
<h2 id="descri%C3%A7%C3%A3o-e-contextualiza%C3%A7%C3%A3o-t%C3%A9cnica">Descrição e Contextualização Técnica</h2>
<p>A configuração incorreta de segurança ocorre quando componentes da stack de tecnologia (servidores, bancos de dados, frameworks) não são protegidos adequadamente, permitindo que atacantes explorem brechas previsíveis. Essa vulnerabilidade é particularmente perigosa por sua natureza <em>silenciosa</em> – muitas organizações não percebem que estão expostas até sofrerem um incidente.</p>
<h3 id="mecanismos-subjacentes">Mecanismos Subjacentes</h3>
<ol>
<li><strong>Configurações Padrão Não Modificadas</strong>: Muitos sistemas são implantados com configurações de fábrica que priorizam facilidade de uso sobre segurança, como credenciais administrativas padrão (ex.: admin/senha) e portas de serviço desnecessárias abertas<a href="https://www.indusface.com/blog/owasp-security-misconfiguration/">^1</a>.</li>
<li><strong>Exposição de Informações Sensíveis</strong>: Mensagens de erro detalhadas, <em>stack traces</em> e páginas de diagnóstico expõem detalhes internos do sistema, fornecendo insights valiosos para atacantes<a href="https://www.youtube.com/watch?v=bmMEBEeyAK4">^1</a>.</li>
<li><strong>Falha na Atualização de Componentes</strong>: Serviços desatualizados ou não corrigidos mantêm vulnerabilidades conhecidas, mesmo quando patches estão disponíveis<a href="https://www.indusface.com/blog/owasp-security-misconfiguration/">^1</a>.</li>
<li><strong>Permissões Excessivas</strong>: Contas de serviço com privilégios elevados além do necessário aumentam a superfície de ataque<a href="https://www.youtube.com/watch?v=bmMEBEeyAK4">^2</a>.</li>
</ol>
<p>Um estudo realizado na plataforma Moodle demonstrou que configurações incorretas estavam entre as cinco principais vulnerabilidades identificadas, afetando diretamente a integridade de ambientes educacionais digitais<a href="https://repositorio.ufu.br/bitstream/123456789/38406/1/EstudoVulnerabilidadesOWASP.pdf">^3</a>.</p>
<h2 id="estrat%C3%A9gias-de-preven%C3%A7%C3%A3o-e-mitiga%C3%A7%C3%A3o">Estratégias de Prevenção e Mitigação</h2>
<h3 id="automa%C3%A7%C3%A3o-de-configura%C3%A7%C3%B5es-seguras">Automação de Configurações Seguras</h3>
<p>A adoção de <strong>Infraestrutura como Código (IaC)</strong> permite definir configurações de segurança de forma programática, garantindo consistência entre ambientes de desenvolvimento, teste e produção. Ferramentas como <em>Xygeni IaC Security</em> automatizam a verificação de parâmetros críticos, como desabilitação de serviços não essenciais e aplicação de políticas de criptografia<a href="https://www.youtube.com/watch?v=bmMEBEeyAK4">^2</a>.</p>
<h3 id="auditorias-cont%C3%ADnuas">Auditorias Contínuas</h3>
<p>Processos de revisão periódica devem incluir:</p>
<ul>
<li>Verificação de contas padrão e senhas não alteradas</li>
<li>Análise de permissões de arquivos e diretórios</li>
<li>Validação de cabeçalhos de segurança (ex.: Content-Security-Policy, X-Content-Type-Options)</li>
<li>Monitoramento de serviços expostos na rede<a href="https://www.youtube.com/watch?v=bmMEBEeyAK4">^1</a></li>
</ul>
<h3 id="princ%C3%ADpio-do-menor-privil%C3%A9gio">Princípio do Menor Privilégio</h3>
<p>A restrição de acesso baseada em funções (<em>RBAC</em>) reduz o impacto potencial de configurações incorretas. Por exemplo, bancos de dados não devem ser acessíveis diretamente da internet, e contas de serviço devem ter privilégios limitados às operações estritamente necessárias<a href="https://www.indusface.com/blog/owasp-security-misconfiguration/">^2</a>.</p>
<h3 id="remedia%C3%A7%C3%A3o-de-vulnerabilidades-conhecidas">Remediação de Vulnerabilidades Conhecidas</h3>
<p>A integração de scanners de vulnerabilidade em pipelines CI/CD ajuda a identificar componentes desatualizados ou mal configurados antes da implantação em produção. O OWASP recomenda o uso combinado de ferramentas como o <strong>OWASP ZAP</strong> para detecção automática de más configurações<a href="https://www.youtube.com/watch?v=bmMEBEeyAK4">^3</a>.</p>
<h2 id="impactos-e-casos-reais">Impactos e Casos Reais</h2>
<h3 id="consequ%C3%AAncias-operacionais">Consequências Operacionais</h3>
<ul>
<li><strong>Exfiltração de Dados</strong>: Configurações incorretas em armazenamentos em nuvem (ex.: buckets S3 públicos) levaram a vazamentos massivos, como o caso da <strong>Primeira Corporação Financeira Americana</strong> em 2019, que expôs 885 milhões de registros<a href="https://xygeni.io/pt/blog/owasp-top-10-and-their-remedies/">^2</a>.</li>
<li><strong>Comprometimento de Sistemas</strong>: O ataque ao <strong>Twitter em 2020</strong> explorou controles de acesso fracos em ferramentas internas, permitindo que invasores assumissem contas de alta visibilidade<a href="https://xygeni.io/pt/blog/owasp-top-10-and-their-remedies/">^2</a>.</li>
<li><strong>Paralisia Operacional</strong>: O ransomware <strong>WannaCry</strong> (2017) aproveitou-se de sistemas Windows não atualizados com a correção MS17-010, demonstrando como a falha em aplicar patches críticos pode ter consequências globais<a href="https://www.youtube.com/watch?v=bmMEBEeyAK4">^5</a>.</li>
</ul>
<h3 id="estudo-de-caso-viola%C3%A7%C3%A3o-do-target-2013">Estudo de Caso: Violação do Target (2013)</h3>
<p>Um exemplo clássico envolveu a cadeia de suprimentos da Target, onde credenciais de terceiro com acesso excessivo ao sistema de HVAC foram usadas como vetor inicial. A falta de segmentação de rede e monitoramento permitiu que os atacantes movessem-se lateralmente até os sistemas de pagamento, comprometendo dados de 40 milhões de cartões<a href="https://www.youtube.com/watch?v=bmMEBEeyAK4">^2</a>.</p>
<h2 id="cen%C3%A1rio-atual-e-tend%C3%AAncias">Cenário Atual e Tendências</h2>
<p>Com a adoção acelerada de tecnologias em nuvem e microsserviços, a complexidade das configurações aumentou exponencialmente. Dados do <strong>Relatório de Ameaças da IBM (2023)</strong> indicam que <strong>68% das violações</strong> envolvem erros de configuração, muitas vezes relacionados a APIs mal protegidas ou serviços de armazenamento expostos.</p>
<p>A ascensão de ambientes <em>serverless</em> e containers introduziu novos desafios:</p>
<ul>
<li>Funções AWS Lambda com permissões excessivas</li>
<li>Clusters Kubernetes sem políticas de NetworkPolicy</li>
<li>Registros de container públicos com imagens vulneráveis</li>
</ul>
<p>Esses cenários demandam abordagens modernas, como a utilização de <em>policy engines</em> (ex.: Open Policy Agent) para impor configurações seguras de forma centralizada<a href="https://www.indusface.com/blog/owasp-security-misconfiguration/">^5</a>.</p>
<h2 id="recomenda%C3%A7%C3%B5es-para-implementa%C3%A7%C3%A3o">Recomendações para Implementação</h2>
<ol>
<li><strong>Modelo de Maturação de Configurações</strong>:
<ul>
<li><strong>Nível Básico</strong>: Remoção de contas padrão, desabilitação de serviços não utilizados</li>
<li><strong>Nível Intermediário</strong>: Automação via ferramentas IaC, integração com scanners SAST/DAST</li>
<li><strong>Nível Avançado</strong>: Adoção de <em>Security-as-Code</em> e monitoramento contínuo com IA/ML<a href="https://www.youtube.com/watch?v=bmMEBEeyAK4">^2</a></li>
</ul>
</li>
<li><strong>Framework de Referência</strong>:
<ul>
<li><strong>CIS Benchmarks</strong>: Diretrizes específicas por tecnologia para configurações seguras</li>
<li><strong>NIST SP 800-123</strong>: Guia para proteção de servidores web</li>
<li><strong>ISO/IEC 27002</strong>: Controles para gestão de operações de TI seguras<a href="https://www.indusface.com/blog/owasp-security-misconfiguration/">^1</a></li>
</ul>
</li>
<li><strong>Cultura Organizacional</strong>:
<ul>
<li>Treinamentos regulares em <em>Secure DevOps</em></li>
<li>Exercícios de <em>red teaming</em> para testar configurações defensivas</li>
<li>Programas de recompensa por identificação de más configurações<a href="https://www.youtube.com/watch?v=bmMEBEeyAK4">^2</a></li>
</ul>
</li>
</ol>
<h2 id="conclus%C3%A3o">Conclusão</h2>
<p>A configuração incorreta de segurança permanece uma ameaça persistente não por sua complexidade técnica, mas pela falta de processos sistemáticos para gerenciar ambientes cada vez mais dinâmicos. A solução exige uma combinação de automação inteligente, educação contínua e adoção de frameworks comprovados. Organizações que integram verificações de segurança em todas as fases do ciclo de vida de desenvolvimento (SDLC) reduzem em até 72% os incidentes relacionados a más configurações<a href="https://www.youtube.com/watch?v=bmMEBEeyAK4">^2</a>.</p>
<p>À medida que a indústria avança para arquiteturas distribuídas e multi-nuvem, a capacidade de manter configurações consistentes e seguras tornou-se não apenas uma prática recomendada, mas um imperativo estratégico para a sobrevivência dos negócios digitais.</p>
<div style="text-align: center">⁂</div>

</body>
</html>
