<!DOCTYPE html>
<html>
<head>
<title>A07 - Identification and Authentication Failures.md</title>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8">

<style>
/* https://github.com/microsoft/vscode/blob/master/extensions/markdown-language-features/media/markdown.css */
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

body {
	font-family: var(--vscode-markdown-font-family, -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif);
	font-size: var(--vscode-markdown-font-size, 14px);
	padding: 0 26px;
	line-height: var(--vscode-markdown-line-height, 22px);
	word-wrap: break-word;
}

#code-csp-warning {
	position: fixed;
	top: 0;
	right: 0;
	color: white;
	margin: 16px;
	text-align: center;
	font-size: 12px;
	font-family: sans-serif;
	background-color:#444444;
	cursor: pointer;
	padding: 6px;
	box-shadow: 1px 1px 1px rgba(0,0,0,.25);
}

#code-csp-warning:hover {
	text-decoration: none;
	background-color:#007acc;
	box-shadow: 2px 2px 2px rgba(0,0,0,.25);
}

body.scrollBeyondLastLine {
	margin-bottom: calc(100vh - 22px);
}

body.showEditorSelection .code-line {
	position: relative;
}

body.showEditorSelection .code-active-line:before,
body.showEditorSelection .code-line:hover:before {
	content: "";
	display: block;
	position: absolute;
	top: 0;
	left: -12px;
	height: 100%;
}

body.showEditorSelection li.code-active-line:before,
body.showEditorSelection li.code-line:hover:before {
	left: -30px;
}

.vscode-light.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(0, 0, 0, 0.15);
}

.vscode-light.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(0, 0, 0, 0.40);
}

.vscode-light.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-dark.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 255, 255, 0.4);
}

.vscode-dark.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 255, 255, 0.60);
}

.vscode-dark.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-high-contrast.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 160, 0, 0.7);
}

.vscode-high-contrast.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 160, 0, 1);
}

.vscode-high-contrast.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

img {
	max-width: 100%;
	max-height: 100%;
}

a {
	text-decoration: none;
}

a:hover {
	text-decoration: underline;
}

a:focus,
input:focus,
select:focus,
textarea:focus {
	outline: 1px solid -webkit-focus-ring-color;
	outline-offset: -1px;
}

hr {
	border: 0;
	height: 2px;
	border-bottom: 2px solid;
}

h1 {
	padding-bottom: 0.3em;
	line-height: 1.2;
	border-bottom-width: 1px;
	border-bottom-style: solid;
}

h1, h2, h3 {
	font-weight: normal;
}

table {
	border-collapse: collapse;
}

table > thead > tr > th {
	text-align: left;
	border-bottom: 1px solid;
}

table > thead > tr > th,
table > thead > tr > td,
table > tbody > tr > th,
table > tbody > tr > td {
	padding: 5px 10px;
}

table > tbody > tr + tr > td {
	border-top: 1px solid;
}

blockquote {
	margin: 0 7px 0 5px;
	padding: 0 16px 0 10px;
	border-left-width: 5px;
	border-left-style: solid;
}

code {
	font-family: Menlo, Monaco, Consolas, "Droid Sans Mono", "Courier New", monospace, "Droid Sans Fallback";
	font-size: 1em;
	line-height: 1.357em;
}

body.wordWrap pre {
	white-space: pre-wrap;
}

pre:not(.hljs),
pre.hljs code > div {
	padding: 16px;
	border-radius: 3px;
	overflow: auto;
}

pre code {
	color: var(--vscode-editor-foreground);
	tab-size: 4;
}

/** Theming */

.vscode-light pre {
	background-color: rgba(220, 220, 220, 0.4);
}

.vscode-dark pre {
	background-color: rgba(10, 10, 10, 0.4);
}

.vscode-high-contrast pre {
	background-color: rgb(0, 0, 0);
}

.vscode-high-contrast h1 {
	border-color: rgb(0, 0, 0);
}

.vscode-light table > thead > tr > th {
	border-color: rgba(0, 0, 0, 0.69);
}

.vscode-dark table > thead > tr > th {
	border-color: rgba(255, 255, 255, 0.69);
}

.vscode-light h1,
.vscode-light hr,
.vscode-light table > tbody > tr + tr > td {
	border-color: rgba(0, 0, 0, 0.18);
}

.vscode-dark h1,
.vscode-dark hr,
.vscode-dark table > tbody > tr + tr > td {
	border-color: rgba(255, 255, 255, 0.18);
}

</style>

<style>
/* Tomorrow Theme */
/* http://jmblog.github.com/color-themes-for-google-code-highlightjs */
/* Original theme - https://github.com/chriskempson/tomorrow-theme */

/* Tomorrow Comment */
.hljs-comment,
.hljs-quote {
	color: #8e908c;
}

/* Tomorrow Red */
.hljs-variable,
.hljs-template-variable,
.hljs-tag,
.hljs-name,
.hljs-selector-id,
.hljs-selector-class,
.hljs-regexp,
.hljs-deletion {
	color: #c82829;
}

/* Tomorrow Orange */
.hljs-number,
.hljs-built_in,
.hljs-builtin-name,
.hljs-literal,
.hljs-type,
.hljs-params,
.hljs-meta,
.hljs-link {
	color: #f5871f;
}

/* Tomorrow Yellow */
.hljs-attribute {
	color: #eab700;
}

/* Tomorrow Green */
.hljs-string,
.hljs-symbol,
.hljs-bullet,
.hljs-addition {
	color: #718c00;
}

/* Tomorrow Blue */
.hljs-title,
.hljs-section {
	color: #4271ae;
}

/* Tomorrow Purple */
.hljs-keyword,
.hljs-selector-tag {
	color: #8959a8;
}

.hljs {
	display: block;
	overflow-x: auto;
	color: #4d4d4c;
	padding: 0.5em;
}

.hljs-emphasis {
	font-style: italic;
}

.hljs-strong {
	font-weight: bold;
}
</style>

<style>
/*
 * Markdown PDF CSS
 */

 body {
	font-family: -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif, "Meiryo";
	padding: 0 12px;
}

pre {
	background-color: #f8f8f8;
	border: 1px solid #cccccc;
	border-radius: 3px;
	overflow-x: auto;
	white-space: pre-wrap;
	overflow-wrap: break-word;
}

pre:not(.hljs) {
	padding: 23px;
	line-height: 19px;
}

blockquote {
	background: rgba(127, 127, 127, 0.1);
	border-color: rgba(0, 122, 204, 0.5);
}

.emoji {
	height: 1.4em;
}

code {
	font-size: 14px;
	line-height: 19px;
}

/* for inline code */
:not(pre):not(.hljs) > code {
	color: #C9AE75; /* Change the old color so it seems less like an error */
	font-size: inherit;
}

/* Page Break : use <div class="page"/> to insert page break
-------------------------------------------------------- */
.page {
	page-break-after: always;
}

</style>

<script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
</head>
<body>
  <script>
    mermaid.initialize({
      startOnLoad: true,
      theme: document.body.classList.contains('vscode-dark') || document.body.classList.contains('vscode-high-contrast')
          ? 'dark'
          : 'default'
    });
  </script>
<h1 id="a07---identification-and-authentication-failures">A07 - Identification and Authentication Failures</h1>
<h2 id="resumo">Resumo</h2>
<p>Falha na autentica√ßao. Enquanto da A01 se preocupa com 'Voc√™ pode fazer isso?&quot;' (se trata de limitar o usu√°rio a apaenas fazer o que ele deve fazer) que √© quando se acessa algo que nao se pdoe, aqui √© quando um cara consegue passar pelo login, √© quando voc√™ &quot;√© quem diz que √©. S√£o problemas que envolve: login, sess√¥es, tokens, recuperar senhas e tentativas de bruteforce pra passar pelo login</p>
<h2 id="links">Links</h2>
<ul>
<li>https://owasp.org/Top10/pt_BR/A07_2021-Identification_and_Authentication_Failures/</li>
</ul>
<h2 id="owasp">OWASP</h2>
<h2 id="descri%C3%A7%C3%A3o">Descri√ß√£o</h2>
<p>Confirma√ß√£o da identidade, autentica√ß√£o e sess√£o do usu√°rio gerenciamento √© fundamental para proteger contra autentica√ß√£o relacionada ataques. Pode haver pontos fracos de autentica√ß√£o se o aplicativo:</p>
<ul>
<li>
<p>Permite ataques automatizados, como preenchimento de credenciais, onde o invasor tem uma lista de nomes de usu√°rios e senhas v√°lidos.</p>
</li>
<li>
<p>Permite for√ßa bruta ou outros ataques automatizados.</p>
</li>
<li>
<p>Permite senhas padr√£o, fracas ou conhecidas, como &quot;Senha1&quot; ou &quot;admin/admin&quot;.</p>
</li>
<li>
<p>Usa recupera√ß√£o de credenciais fraca ou ineficaz e esqueci a senha processos, como &quot;respostas baseadas em conhecimento&quot;, que n√£o podem ser feitas de modo seguro.</p>
</li>
<li>
<p>Usa armazenamento de dados e senhas em texto simples, criptografadas ou com hash fraco (consulte  <a href="https://owasp.org/Top10/pt_BR/A02_2021-Cryptographic_Failures/">A02:2021-Falhas Criptogr√°ficas</a>).</p>
</li>
<li>
<p>Possui multifator de autentica√ß√£o ausente ou ineficaz.</p>
</li>
<li>
<p>Exp√µe o identificador de sess√£o na URL.</p>
</li>
<li>
<p>Reutiliza o identificador de sess√£o ap√≥s o login bem-sucedido.</p>
</li>
<li>
<p>N√£o invalida corretamente IDs de sess√£o. Sess√µes de usu√°rio ou tokens de autentica√ß√£o (principalmente tokens de logon √∫nico (SSO)) n√£o s√£o devidamente invalidado durante o logout ou um per√≠odo de inatividade.</p>
</li>
</ul>
<h2 id="como-prevenir">Como Prevenir</h2>
<ul>
<li>
<p>Sempre que poss√≠vel, implemente a autentica√ß√£o multifator para evitar preenchimento automatizado de credenciais, for√ßa bruta e credenciais roubadas</p>
</li>
<li>
<p>N√£o permita ou implante nenhuma credencial padr√£o, especialmente para usu√°rios administradores.</p>
</li>
<li>
<p>Implementar verifica√ß√µes de senha fraca, como testar novas ou alteradas contra a lista das 10.000 piores senhas.</p>
</li>
<li>
<p>Alinhe o comprimento da senha, a complexidade e as pol√≠ticas de rota√ß√£o com Instituto Nacional de Padr√µes e Tecnologia (NIST) as diretrizes do 800-63b na se√ß√£o 5.1.1 para segredos memorizados ou outras pol√≠ticas de senha modernas e baseadas em evid√™ncias.</p>
</li>
<li>
<p>Certifique-se de que o registro, a recupera√ß√£o de credenciais e os caminhos da API sejam protegido contra ataques de enumera√ß√£o de contas usando a mesma mensagens para todos os resultados.</p>
</li>
<li>
<p>Limite ou atrase cada vez mais as tentativas de login com falha, mas tome cuidado para n√£o criar um cen√°rio de nega√ß√£o de servi√ßo. Registrar todas as falhas e alertar os administradores quando o preenchimento de credenciais, for√ßa bruta ou outros ataques s√£o detectados.</p>
</li>
<li>
<p>Use um gerenciador de sess√£o integrado, seguro do lado do servidor que gere um novo ID de sess√£o aleat√≥ria com alta entropia ap√≥s o login. Identificador de sess√£o n√£o deve estar na URL, deve ser armazenado com seguran√ßa e invalidado ap√≥s o logout.</p>
</li>
</ul>
<h2 id="exemplos-de-cen%C3%A1rios-de-ataque">Exemplos de Cen√°rios de Ataque</h2>
<p><strong>Cen√°rio 1:</strong>  O preenchimento de credenciais, que consiste no uso de listas de senhas conhecidas, √© um ataque comum. Suponha que um aplicativo n√£o implemente prote√ß√£o automatizada contra amea√ßas ou preenchimento de credenciais. Nesse caso, o aplicativo pode ser usado como um or√°culo de senhas para determinar se as credenciais s√£o v√°lidas.</p>
<p><strong>Cen√°rio 2:</strong>  A maioria dos ataques de autentica√ß√£o ocorre devido ao uso cont√≠nuo de senhas como √∫nico fator. Antes considerada uma boa pr√°tica, a rota√ß√£o de senhas e os requisitos de complexidade encorajam os usu√°rios a usar e reutilizar senhas fracas. As organiza√ß√µes s√£o recomendadas a interromper essas pr√°ticas conforme a norma NIST 800-63 e usar autentica√ß√£o de m√∫ltiplos fatores.</p>
<p><strong>Cen√°rio 3:</strong>  Os tempos limite da sess√£o do aplicativo n√£o est√£o definidos corretamente. Um usu√°rio usa um computador p√∫blico para acessar um aplicativo. Em vez de selecionar &quot;sair&quot;, o usu√°rio simplesmente fecha a aba do navegador e sai. Uma hora depois, um atacante usa o mesmo navegador, e o usu√°rio ainda est√° autenticado.</p>
<h2 id="refer%C3%AAncias">Refer√™ncias</h2>
<ul>
<li>
<p><a href="https://owasp.org/www-project-proactive-controls/v3/en/c6-digital-identity">OWASP Proactive Controls: Implement Digital Identity</a></p>
</li>
<li>
<p><a href="https://owasp.org/www-project-application-security-verification-standard">OWASP Application Security Verification Standard: V2 authentication</a></p>
</li>
<li>
<p><a href="https://owasp.org/www-project-application-security-verification-standard">OWASP Application Security Verification Standard: V3 Session Management</a></p>
</li>
<li>
<p><a href="https://owasp.org/www-project-web-security-testing-guide/stable/4-Web_Application_Security_Testing/03-Identity_Management_Testing/README">OWASP Testing Guide: Identity</a>, <a href="https://owasp.org/www-project-web-security-testing-guide/stable/4-Web_Application_Security_Testing/04-Authentication_Testing/README">Authentication</a></p>
</li>
<li>
<p><a href="https://cheatsheetseries.owasp.org/cheatsheets/Authentication_Cheat_Sheet.html">OWASP Cheat Sheet: Authentication</a></p>
</li>
<li>
<p><a href="https://cheatsheetseries.owasp.org/cheatsheets/Credential_Stuffing_Prevention_Cheat_Sheet.html">OWASP Cheat Sheet: Credential Stuffing</a></p>
</li>
<li>
<p><a href="https://cheatsheetseries.owasp.org/cheatsheets/Forgot_Password_Cheat_Sheet.html">OWASP Cheat Sheet: Forgot Password</a></p>
</li>
<li>
<p><a href="https://cheatsheetseries.owasp.org/cheatsheets/Session_Management_Cheat_Sheet.html">OWASP Cheat Sheet: Session Management</a></p>
</li>
<li>
<p><a href="https://owasp.org/www-project-automated-threats-to-web-applications/">OWASP Automated Threats Handbook</a></p>
</li>
<li>
<p>NIST 800-63b: 5.1.1 Memorized Secrets</p>
</li>
</ul>
<h2 id="lista-dos-cwes-mapeados">Lista dos CWEs Mapeados</h2>
<p><a href="https://cwe.mitre.org/data/definitions/255.html">CWE-255 Credentials Management Errors</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/259.html">CWE-259 Use of Hard-coded Password</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/287.html">CWE-287 Improper Authentication</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/288.html">CWE-288 Authentication Bypass Using an Alternate Path or Channel</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/290.html">CWE-290 Authentication Bypass by Spoofing</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/294.html">CWE-294 Authentication Bypass by Capture-replay</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/295.html">CWE-295 Improper Certificate Validation</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/297.html">CWE-297 Improper Validation of Certificate with Host Mismatch</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/300.html">CWE-300 Channel Accessible by Non-Endpoint</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/302.html">CWE-302 Authentication Bypass by Assumed-Immutable Data</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/304.html">CWE-304 Missing Critical Step in Authentication</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/306.html">CWE-306 Missing Authentication for Critical Function</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/307.html">CWE-307 Improper Restriction of Excessive Authentication Attempts</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/346.html">CWE-346 Origin Validation Error</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/384.html">CWE-384 Session Fixation</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/521.html">CWE-521 Weak Password Requirements</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/613.html">CWE-613 Insufficient Session Expiration</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/620.html">CWE-620 Unverified Password Change</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/640.html">CWE-640 Weak Password Recovery Mechanism for Forgotten Password</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/798.html">CWE-798 Use of Hard-coded Credentials</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/940.html">CWE-940 Improper Verification of Source of a Communication Channel</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/1216.html">CWE-1216 Lockout Mechanism Errors</a></p>
<h2 id="chatgp">ChatGP</h2>
<h3 id="q1">Q1</h3>
<blockquote>
<p>Fale sobre AO07 Identification and Authentication Failures do Owasp</p>
</blockquote>
<p>A vulnerabilidade <strong>AO07 ‚Äì Identification and Authentication Failures</strong> da <a href="https://owasp.org/Top10/">OWASP Top 10</a> refere-se a <strong>falhas na identifica√ß√£o e autentica√ß√£o de usu√°rios</strong>, o que pode permitir que atacantes acessem sistemas de forma indevida, assumam identidades ou contornem mecanismos de seguran√ßa.</p>
<hr>
<p>üîç O que √© a AO07?</p>
<p>Essa categoria inclui <strong>problemas em processos de login, logout, gest√£o de sess√µes, recupera√ß√£o de senhas, autentica√ß√£o multifator</strong>, entre outros. Um sistema vulner√°vel nesta categoria <strong>n√£o protege adequadamente as credenciais ou n√£o verifica corretamente a identidade do usu√°rio</strong> antes de permitir acesso.</p>
<hr>
<p>‚ö†Ô∏è Exemplos de falhas comuns</p>
<ul>
<li>Uso de senhas fracas ou padr√µes f√°ceis de adivinhar.</li>
<li>Falta de <strong>autentica√ß√£o multifator (MFA)</strong> onde √© necess√°rio.</li>
<li>Exposi√ß√£o de informa√ß√µes sens√≠veis em mensagens de erro (como ‚Äúusu√°rio n√£o encontrado‚Äù).</li>
<li>Tokens de sess√£o expiram muito lentamente ou nunca expiram.</li>
<li>Tokens de autentica√ß√£o previs√≠veis.</li>
<li>Falta de limita√ß√£o de tentativas de login (prote√ß√£o contra <strong>ataques de for√ßa bruta</strong>).</li>
<li>Autentica√ß√£o implementada de forma customizada e insegura.</li>
</ul>
<hr>
<p>üîê Como prevenir</p>
<ul>
<li>Exigir senhas fortes e pol√≠ticas de troca segura.</li>
<li>Implementar <strong>MFA</strong> (autentica√ß√£o multifator).</li>
<li>Utilizar <strong>limita√ß√£o de tentativas de login</strong> com bloqueios tempor√°rios (Rate Limiting).</li>
<li>Evitar mensagens de erro que revelam se o usu√°rio ou senha est√£o incorretos.</li>
<li>Utilizar bibliotecas seguras para autentica√ß√£o e <strong>n√£o reinventar a roda</strong>.</li>
<li>Proteger tokens de sess√£o com atributos como <code>HttpOnly</code>, <code>Secure</code> e <code>SameSite</code>.</li>
<li>Encerrar sess√µes de forma apropriada no logout e ap√≥s inatividade.</li>
<li>Armazenar senhas com algoritmos seguros (ex.: bcrypt, Argon2).</li>
</ul>
<hr>
<p>üß† Exemplo pr√°tico</p>
<p>Um sistema com um login onde √© poss√≠vel tentar senhas ilimitadamente sem bloqueio ou atraso est√° vulner√°vel a um <strong>ataque de for√ßa bruta</strong>. Outro exemplo seria retornar mensagens como:</p>
<blockquote>
<p>&quot;Usu√°rio n√£o encontrado&quot;</p>
</blockquote>
<p>em vez de algo gen√©rico como:</p>
<blockquote>
<p>&quot;Usu√°rio ou senha inv√°lidos&quot;</p>
</blockquote>
<p>Isso facilita ataques de enumera√ß√£o de usu√°rios.</p>
<hr>
<p>üìå Conclus√£o</p>
<p>A AO07 trata da <strong>seguran√ßa fundamental de autentica√ß√£o e sess√µes</strong>. Se um atacante conseguir se passar por outro usu√°rio ‚Äî especialmente um administrador ‚Äî ele pode ter acesso total ao sistema. Portanto, <strong>a prote√ß√£o adequada de credenciais e sess√µes √© uma das prioridades de seguran√ßa mais cr√≠ticas em qualquer aplica√ß√£o</strong>.</p>
<p>Gostaria de ver um checklist pr√°tico ou c√≥digo exemplo com boas pr√°ticas de autentica√ß√£o?</p>
<h3 id="q2">Q2</h3>
<blockquote>
<p>D√™ exemplos de c√≥digo em php puro com essa falhas e a versoa corrigindo essa falhas</p>
</blockquote>
<p>Claro! Abaixo est√£o <strong>exemplos de c√≥digo em PHP puro com falhas relacionadas √† AO07 (Identification and Authentication Failures)</strong> e suas <strong>vers√µes corrigidas</strong>.</p>
<hr>
<h2 id="%F0%9F%9A%A8-1-senha-armazenada-sem-hash">üö® 1. <strong>Senha armazenada sem hash</strong></h2>
<h3 id="%E2%9D%8C-vulner%C3%A1vel">‚ùå Vulner√°vel:</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Armazenando senha diretamente</span>
$password = $_POST[<span class="hljs-string">'password'</span>];
$sql = <span class="hljs-string">"INSERT INTO users (username, password) VALUES ('{$_POST['username']}', '$password')"</span>;
mysqli_query($conn, $sql);
</div></code></pre>
<h3 id="%E2%9C%85-correto">‚úÖ Correto:</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Armazenando senha com hash seguro</span>
$password = password_hash($_POST[<span class="hljs-string">'password'</span>], PASSWORD_BCRYPT);
$sql = <span class="hljs-string">"INSERT INTO users (username, password) VALUES (?, ?)"</span>;
$stmt = $conn-&gt;prepare($sql);
$stmt-&gt;bind_param(<span class="hljs-string">'ss'</span>, $_POST[<span class="hljs-string">'username'</span>], $password);
$stmt-&gt;execute();
</div></code></pre>
<hr>
<h2 id="%F0%9F%9A%A8-2-login-sem-prote%C3%A7%C3%A3o-contra-for%C3%A7a-bruta">üö® 2. <strong>Login sem prote√ß√£o contra for√ßa bruta</strong></h2>
<h3 id="%E2%9D%8C-vulner%C3%A1vel">‚ùå Vulner√°vel:</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Tentativas ilimitadas</span>
$sql = <span class="hljs-string">"SELECT * FROM users WHERE username = '{$_POST['username']}'"</span>;
$result = mysqli_query($conn, $sql);
$user = mysqli_fetch_assoc($result);

<span class="hljs-keyword">if</span> ($user &amp;&amp; $user[<span class="hljs-string">'password'</span>] === $_POST[<span class="hljs-string">'password'</span>]) {
    <span class="hljs-keyword">echo</span> <span class="hljs-string">"Bem-vindo!"</span>;
} <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">echo</span> <span class="hljs-string">"Usu√°rio ou senha incorretos."</span>;
}
</div></code></pre>
<h3 id="%E2%9C%85-correto-com-hash-e-limita%C3%A7%C3%A3o-simples">‚úÖ Correto (com hash e limita√ß√£o simples):</h3>
<pre class="hljs"><code><div>session_start();

$username = $_POST[<span class="hljs-string">'username'</span>];
$password = $_POST[<span class="hljs-string">'password'</span>];

<span class="hljs-comment">// Simples controle de tentativas</span>
<span class="hljs-keyword">if</span> (!<span class="hljs-keyword">isset</span>($_SESSION[<span class="hljs-string">'attempts'</span>])) $_SESSION[<span class="hljs-string">'attempts'</span>] = <span class="hljs-number">0</span>;
<span class="hljs-keyword">if</span> ($_SESSION[<span class="hljs-string">'attempts'</span>] &gt;= <span class="hljs-number">5</span>) {
    <span class="hljs-keyword">die</span>(<span class="hljs-string">"Muitas tentativas. Tente novamente mais tarde."</span>);
}

$sql = <span class="hljs-string">"SELECT * FROM users WHERE username = ?"</span>;
$stmt = $conn-&gt;prepare($sql);
$stmt-&gt;bind_param(<span class="hljs-string">'s'</span>, $username);
$stmt-&gt;execute();
$result = $stmt-&gt;get_result();
$user = $result-&gt;fetch_assoc();

<span class="hljs-keyword">if</span> ($user &amp;&amp; password_verify($password, $user[<span class="hljs-string">'password'</span>])) {
    <span class="hljs-keyword">echo</span> <span class="hljs-string">"Login bem-sucedido!"</span>;
    $_SESSION[<span class="hljs-string">'attempts'</span>] = <span class="hljs-number">0</span>; <span class="hljs-comment">// reset</span>
} <span class="hljs-keyword">else</span> {
    $_SESSION[<span class="hljs-string">'attempts'</span>]++;
    <span class="hljs-keyword">echo</span> <span class="hljs-string">"Usu√°rio ou senha incorretos."</span>;
}
</div></code></pre>
<hr>
<h2 id="%F0%9F%9A%A8-3-token-de-sess%C3%A3o-n%C3%A3o-regenerado-no-login">üö® 3. <strong>Token de sess√£o n√£o regenerado no login</strong></h2>
<h3 id="%E2%9D%8C-vulner%C3%A1vel">‚ùå Vulner√°vel:</h3>
<pre class="hljs"><code><div>session_start();
$_SESSION[<span class="hljs-string">'user_id'</span>] = $user[<span class="hljs-string">'id'</span>];
</div></code></pre>
<h3 id="%E2%9C%85-correto">‚úÖ Correto:</h3>
<pre class="hljs"><code><div>session_start();
session_regenerate_id(<span class="hljs-keyword">true</span>); <span class="hljs-comment">// evita fixation</span>
$_SESSION[<span class="hljs-string">'user_id'</span>] = $user[<span class="hljs-string">'id'</span>];
</div></code></pre>
<hr>
<h2 id="%F0%9F%9A%A8-4-exposi%C3%A7%C3%A3o-de-mensagens-espec%C3%ADficas-de-erro">üö® 4. <strong>Exposi√ß√£o de mensagens espec√≠ficas de erro</strong></h2>
<h3 id="%E2%9D%8C-vulner%C3%A1vel">‚ùå Vulner√°vel:</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">if</span> (!$user) {
    <span class="hljs-keyword">echo</span> <span class="hljs-string">"Usu√°rio n√£o encontrado."</span>;
} <span class="hljs-keyword">elseif</span> (!password_verify($password, $user[<span class="hljs-string">'password'</span>])) {
    <span class="hljs-keyword">echo</span> <span class="hljs-string">"Senha incorreta."</span>;
}
</div></code></pre>
<h3 id="%E2%9C%85-correto">‚úÖ Correto:</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">if</span> (!$user || !password_verify($password, $user[<span class="hljs-string">'password'</span>])) {
    <span class="hljs-keyword">echo</span> <span class="hljs-string">"Usu√°rio ou senha inv√°lidos."</span>;
}
</div></code></pre>
<hr>
<h2 id="%F0%9F%9A%A8-5-senha-fraca-e-sem-valida%C3%A7%C3%A3o">üö® 5. <strong>Senha fraca e sem valida√ß√£o</strong></h2>
<h3 id="%E2%9D%8C-vulner%C3%A1vel">‚ùå Vulner√°vel:</h3>
<pre class="hljs"><code><div>$password = $_POST[<span class="hljs-string">'password'</span>]; <span class="hljs-comment">// qualquer senha permitida</span>
</div></code></pre>
<h3 id="%E2%9C%85-correto">‚úÖ Correto:</h3>
<pre class="hljs"><code><div>$password = $_POST[<span class="hljs-string">'password'</span>];

<span class="hljs-keyword">if</span> (strlen($password) &lt; <span class="hljs-number">8</span> || !preg_match(<span class="hljs-string">'/[A-Z]/'</span>, $password) ||
    !preg_match(<span class="hljs-string">'/[a-z]/'</span>, $password) || !preg_match(<span class="hljs-string">'/[0-9]/'</span>, $password)) {
    <span class="hljs-keyword">die</span>(<span class="hljs-string">"Senha fraca. Use pelo menos 8 caracteres, com letras mai√∫sculas, min√∫sculas e n√∫meros."</span>);
}
</div></code></pre>
<hr>
<p>Se quiser, posso juntar todos esses exemplos num <strong>mini sistema de login em PHP puro com boas pr√°ticas</strong>. Gostaria disso?</p>
<h3 id="q3">Q3</h3>
<blockquote>
<p>N√£o entendi essa quest√£o de regenera√ß√£o do token no login, me explique o que √© qual a falha de nao ter e o que acontece ao colocar</p>
</blockquote>
<p>√ìtima pergunta, Rafael! Vamos destrinchar isso com clareza.</p>
<hr>
<h2 id="%F0%9F%94%90-o-que-%C3%A9-regenerar-o-token-de-sess%C3%A3o-session-id">üîê <strong>O que √© regenerar o token de sess√£o (session ID)?</strong></h2>
<p>Toda vez que algu√©m acessa seu site e inicia uma sess√£o (<code>session_start()</code>), o PHP gera um <strong>ID de sess√£o √∫nico</strong> (session ID), geralmente armazenado em um cookie. Esse ID √© o &quot;cart√£o de acesso&quot; que identifica o usu√°rio logado nas requisi√ß√µes seguintes.</p>
<hr>
<h2 id="%E2%9A%A0%EF%B8%8F-qual-%C3%A9-o-problema-de-n%C3%A3o-regenerar-esse-id-no-login">‚ö†Ô∏è Qual √© o problema de <strong>n√£o regenerar</strong> esse ID no login?</h2>
<p>Se voc√™ <strong>n√£o regenerar</strong> o session ID no momento do login, <strong>voc√™ permite um tipo de ataque chamado <em>Session Fixation</em></strong>. Veja o que acontece:</p>
<h3 id="%F0%9F%A7%A8-cen%C3%A1rio-de-ataque-session-fixation">üß® <strong>Cen√°rio de ataque (Session Fixation)</strong>:</h3>
<ol>
<li>O atacante cria um link com um session ID espec√≠fico:
<code>https://exemplo.com/?PHPSESSID=attacker123</code></li>
<li>A v√≠tima clica no link e come√ßa a navegar com aquele ID.</li>
<li>A v√≠tima faz login normalmente, mas <strong>continua usando o session ID fornecido pelo atacante</strong>.</li>
<li>O atacante agora acessa o site com o mesmo ID (<code>attacker123</code>) e... <strong>est√° autenticado como a v√≠tima!</strong></li>
</ol>
<hr>
<h2 id="%E2%9C%85-o-que-fazer-regenerar-o-id-no-login">‚úÖ O que fazer? <strong>Regenerar o ID no login!</strong></h2>
<p>Ao usar:</p>
<pre class="hljs"><code><div>session_regenerate_id(<span class="hljs-keyword">true</span>);
</div></code></pre>
<p>...voc√™ est√° <strong>gerando um novo session ID seguro no momento do login</strong> e <strong>invalidando o anterior</strong>. Isso quebra completamente o ataque de <em>session fixation</em>.</p>
<hr>
<h3 id="%E2%9C%94%EF%B8%8F-correto-protegido">‚úîÔ∏è Correto (protegido):</h3>
<pre class="hljs"><code><div>session_start();

<span class="hljs-comment">// Ap√≥s validar login:</span>
session_regenerate_id(<span class="hljs-keyword">true</span>); <span class="hljs-comment">// &lt;-- Garante que o session ID n√£o foi "plantado"</span>
$_SESSION[<span class="hljs-string">'user_id'</span>] = $user[<span class="hljs-string">'id'</span>];
</div></code></pre>
<hr>
<h3 id="%F0%9F%93%8C-resumo">üìå Resumo:</h3>
<table>
<thead>
<tr>
<th>Situa√ß√£o</th>
<th>Consequ√™ncia</th>
</tr>
</thead>
<tbody>
<tr>
<td>‚ùå N√£o regenera session ID</td>
<td>Risco de <em>session fixation</em></td>
</tr>
<tr>
<td>‚úÖ Regenera session ID no login</td>
<td>Garante que a sess√£o do usu√°rio √© segura</td>
</tr>
</tbody>
</table>
<hr>
<p>Se quiser, posso simular esse ataque com c√≥digo ou mostrar como ele seria feito na pr√°tica. Quer ver?</p>
<h2 id="q4---simula%C3%A7%C3%A3o-de-um-ataque">Q4 - Simula√ß√£o de um ataque</h2>
<blockquote>
<p>Simule esse ataque</p>
</blockquote>
<p>Perfeito, Rafael! Vamos simular o ataque de <strong>Session Fixation</strong> com c√≥digo em PHP puro ‚Äî e depois ver como evit√°-lo.</p>
<hr>
<h2 id="%F0%9F%A7%A8-simula%C3%A7%C3%A3o-do-ataque-de-session-fixation">üß® <strong>Simula√ß√£o do ataque de Session Fixation</strong></h2>
<h3 id="%F0%9F%A7%91%E2%80%8D%F0%9F%92%BB-passo-1-%E2%80%93-o-atacante-gera-um-link-com-um-id-de-sess%C3%A3o-%22fixado%22">üßë‚Äçüíª Passo 1 ‚Äì O atacante gera um link com um ID de sess√£o &quot;fixado&quot;</h3>
<p>O atacante manda para a v√≠tima um link como:</p>
<pre class="hljs"><code><div>http://localhost/app.php?PHPSESSID=ABC123
</div></code></pre>
<p>O c√≥digo <code>app.php</code> est√° assim:</p>
<pre class="hljs"><code><div><span class="hljs-comment">// app.php</span>
session_start();
<span class="hljs-keyword">echo</span> <span class="hljs-string">"Session ID: "</span> . session_id();
</div></code></pre>
<p>‚û°Ô∏è Quando a v√≠tima acessa esse link, ela come√ßa a usar o <code>PHPSESSID=ABC123</code>.</p>
<hr>
<h3 id="%F0%9F%91%A4-passo-2-%E2%80%93-a-v%C3%ADtima-se-loga-no-sistema">üë§ Passo 2 ‚Äì A v√≠tima se loga no sistema</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// login.php</span>
session_start();

<span class="hljs-comment">// Simulando autentica√ß√£o (sem regenerar o ID!)</span>
<span class="hljs-keyword">if</span> ($_POST[<span class="hljs-string">'user'</span>] === <span class="hljs-string">'rafael'</span> &amp;&amp; $_POST[<span class="hljs-string">'pass'</span>] === <span class="hljs-string">'123'</span>) {
    $_SESSION[<span class="hljs-string">'user'</span>] = $_POST[<span class="hljs-string">'user'</span>];
    <span class="hljs-keyword">echo</span> <span class="hljs-string">"Usu√°rio logado com session ID: "</span> . session_id();
}
</div></code></pre>
<p>‚û°Ô∏è O login aceita a sess√£o <strong>ABC123</strong>, criada externamente. A sess√£o foi ‚Äúsequestrada‚Äù.</p>
<hr>
<h3 id="%F0%9F%A7%99%E2%80%8D%E2%99%82%EF%B8%8F-passo-3-%E2%80%93-o-atacante-acessa-o-sistema-com-o-mesmo-id">üßô‚Äç‚ôÇÔ∏è Passo 3 ‚Äì O atacante acessa o sistema com o mesmo ID</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// painel.php</span>
session_start();

<span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>($_SESSION[<span class="hljs-string">'user'</span>])) {
    <span class="hljs-keyword">echo</span> <span class="hljs-string">"Bem-vindo, "</span> . $_SESSION[<span class="hljs-string">'user'</span>];
} <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">echo</span> <span class="hljs-string">"Acesso negado."</span>;
}
</div></code></pre>
<p>‚û°Ô∏è O atacante acessa <code>painel.php</code> com <code>PHPSESSID=ABC123</code> e‚Ä¶
‚úÖ <strong>est√° autenticado como Rafael.</strong></p>
<hr>
<h2 id="%E2%9C%85-como-corrigir-regenerar-o-session-id-ap%C3%B3s-o-login">‚úÖ <strong>Como corrigir? Regenerar o session ID ap√≥s o login</strong></h2>
<p>Altere <code>login.php</code>:</p>
<pre class="hljs"><code><div><span class="hljs-comment">// login.php</span>
session_start();

<span class="hljs-keyword">if</span> ($_POST[<span class="hljs-string">'user'</span>] === <span class="hljs-string">'rafael'</span> &amp;&amp; $_POST[<span class="hljs-string">'pass'</span>] === <span class="hljs-string">'123'</span>) {
    session_regenerate_id(<span class="hljs-keyword">true</span>); <span class="hljs-comment">// üîê Protege a sess√£o</span>
    $_SESSION[<span class="hljs-string">'user'</span>] = $_POST[<span class="hljs-string">'user'</span>];
    <span class="hljs-keyword">echo</span> <span class="hljs-string">"Usu√°rio logado com session ID: "</span> . session_id();
}
</div></code></pre>
<p>Agora, mesmo que a v√≠tima tenha iniciado com <code>ABC123</code>, ao fazer login, o PHP gera um <strong>novo ID aleat√≥rio e seguro</strong>, como <code>XYZ789</code>, e o atacante perde o acesso.</p>
<hr>
<h2 id="%F0%9F%9B%A1%EF%B8%8F-conclus%C3%A3o">üõ°Ô∏è Conclus√£o</h2>
<ul>
<li><strong>Session Fixation</strong> ocorre quando voc√™ <strong>permite que o session ID seja controlado externamente</strong> e n√£o o troca no login.</li>
<li>A prote√ß√£o √© simples:
‚ûú <strong>Use <code>session_regenerate_id(true)</code> ap√≥s autenticar o usu√°rio.</strong></li>
</ul>
<p>Quer que eu te mande todos os arquivos <code>.php</code> organizados para voc√™ testar localmente?</p>
<h3 id="q5---qual-a-difenre%C3%A7a-entre-a01-e-a07">Q5 - Qual a difenre√ßa entre A01 e A07</h3>
<p>√ìtima pergunta, Rafael! A <strong>diferen√ßa entre A07 (Identification and Authentication Failures)</strong> e <strong>A01 (Broken Access Control)</strong> √© sutil, mas muito importante. Elas tratam de <strong>momentos diferentes</strong> no controle de acesso:</p>
<hr>
<h2 id="%F0%9F%94%90-a07-identification-and-authentication-failures">üîê A07: Identification and Authentication Failures</h2>
<p><strong>‚û°Ô∏è Trata do &quot;quem √© voc√™?&quot;</strong></p>
<ul>
<li>Est√° relacionada √† <strong>verifica√ß√£o da identidade</strong> do usu√°rio.</li>
<li>Foca em falhas no <strong>login</strong>, senhas fracas, sess√µes inseguras, aus√™ncia de MFA, etc.</li>
<li>O problema aqui √© quando o sistema <strong>n√£o confirma corretamente a identidade do usu√°rio</strong>.</li>
</ul>
<p>üìå <strong>Exemplo de falha</strong>:
Um sistema que permite acesso com senha ‚Äú123456‚Äù ou que n√£o invalida a sess√£o antiga ap√≥s login.</p>
<hr>
<h2 id="%F0%9F%9A%AB-a01-broken-access-control">üö´ A01: Broken Access Control</h2>
<p><strong>‚û°Ô∏è Trata do &quot;voc√™ pode acessar isso?&quot;</strong></p>
<ul>
<li>O usu√°rio j√° est√° autenticado, mas o sistema <strong>n√£o limita corretamente o que ele pode fazer</strong>.</li>
<li>Refere-se a falhas nas <strong>autoriza√ß√£o de acesso</strong> a recursos, a√ß√µes e dados.</li>
<li>O problema √© o sistema <strong>n√£o impedir que um usu√°rio acesse recursos que n√£o deveria</strong>.</li>
</ul>
<p>üìå <strong>Exemplo de falha</strong>:
Um usu√°rio comum acessa <code>/admin/relatorios</code> e visualiza dados confidenciais porque a URL n√£o valida se ele √© admin.</p>
<hr>
<h2 id="%F0%9F%A7%A0-resumo-da-diferen%C3%A7a">üß† Resumo da diferen√ßa</h2>
<table>
<thead>
<tr>
<th>Aspecto</th>
<th>A07 ‚Äì Autentica√ß√£o (Quem √©?)</th>
<th>A01 ‚Äì Controle de Acesso (O que pode?)</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Foco</strong></td>
<td>Identidade e login</td>
<td>Permiss√µes e restri√ß√µes</td>
</tr>
<tr>
<td><strong>Momento</strong></td>
<td>Durante o login/autentica√ß√£o</td>
<td>Ap√≥s login, no uso da aplica√ß√£o</td>
</tr>
<tr>
<td><strong>Consequ√™ncia</strong></td>
<td>Qualquer um pode se passar por outro</td>
<td>Usu√°rios comuns acessam dados restritos</td>
</tr>
<tr>
<td><strong>Corre√ß√£o t√≠pica</strong></td>
<td>MFA, senha forte, session segura</td>
<td>Middleware, ACLs, verifica√ß√£o de roles</td>
</tr>
</tbody>
</table>
<hr>
<p>Se quiser, posso te mostrar exemplos pr√°ticos de c√≥digo com as duas falhas para voc√™ comparar. Deseja isso?</p>
<h3 id="q6---resumoindo">Q6 - Resumoindo</h3>
<p>A vulnerabilidade <strong>A07:2021 ‚Äì Falhas de Identifica√ß√£o e Autentica√ß√£o</strong> do OWASP Top 10 refere-se a defici√™ncias nos processos de identifica√ß√£o e autentica√ß√£o de usu√°rios, permitindo que atacantes acessem sistemas de forma n√£o autorizada.</p>
<hr>
<h3 id="%F0%9F%93%8C-resumo-em-poucas-palavras">üìå <strong>Resumo em poucas palavras</strong></h3>
<p>A07 ocorre quando aplica√ß√µes n√£o identificam ou autenticam usu√°rios corretamente, possibilitando que atacantes assumam identidades ou acessem dados restritos.)</p>
<hr>
<h3 id="%F0%9F%94%8D-onde-ocorre">üîç <strong>Onde ocorre</strong></h3>
<p>Essas falhas podem ocorrer em:</p>
<ul>
<li><strong>Formul√°rios de login</strong>: sem prote√ß√£o contra tentativas repetidas ou uso de senhas fracas.</li>
<li><strong>Gerenciamento de sess√µes</strong>: tokens de sess√£o previs√≠veis ou n√£o invalidados ap√≥s logout.</li>
<li><strong>Recupera√ß√£o de senhas</strong>: processos inseguros que permitem redefini√ß√µes n√£o autorizadas.</li>
<li><strong>APIs</strong>: endpoints que n√£o verificam adequadamente a identidade do solicitante.</li>
</ul>
<hr>
<h3 id="%F0%9F%9B%A1%EF%B8%8F-como-tratar">üõ°Ô∏è <strong>Como tratar</strong></h3>
<p>Para mitigar essas falhas:</p>
<ul>
<li><strong>Implementar autentica√ß√£o multifator (MFA)</strong>: adiciona uma camada extra de seguran√ßa.</li>
<li><strong>Enforce pol√≠ticas de senhas fortes</strong>: exigir combina√ß√µes de letras, n√∫meros e caracteres especiais.</li>
<li><strong>Limitar tentativas de login</strong>: bloquear ou retardar ap√≥s m√∫ltiplas tentativas falhas.</li>
<li><strong>Gerenciar sess√µes de forma segura</strong>: invalidar tokens ap√≥s logout e usar cookies seguros.</li>
<li><strong>Evitar mensagens de erro espec√≠ficas</strong>: n√£o revelar se o usu√°rio ou a senha est√£o incorretos.()</li>
</ul>
<p>--==================
--==================
--==================</p>
<img src="https://r2cdn.perplexity.ai/pplx-full-logo-primary-dark%402x.png" class="logo" width="120"/>
<h1 id="perplexity--a072021---falhas-de-identifica%C3%A7%C3%A3o-e-autentica%C3%A7%C3%A3o-an%C3%A1lise-detalhada-e-estrat%C3%A9gias-de-mitiga%C3%A7%C3%A3o">Perplexity == A07:2021 - Falhas de Identifica√ß√£o e Autentica√ß√£o: An√°lise Detalhada e Estrat√©gias de Mitiga√ß√£o</h1>
<p>Esta an√°lise aprofundada aborda a categoria A07:2021 do OWASP Top 10, dedicada a falhas de identifica√ß√£o e autentica√ß√£o. Originalmente conhecida como &quot;Quebra de Autentica√ß√£o&quot;, esta vulnerabilidade permanece cr√≠tica, apesar de ter ca√≠do da segunda para a s√©tima posi√ß√£o na edi√ß√£o de 2021. Sua relev√¢ncia persiste devido √† frequ√™ncia de ataques automatizados e ao impacto devastador que falhas nesses mecanismos podem causar em sistemas cr√≠ticos.</p>
<h2 id="contextualiza%C3%A7%C3%A3o-e-import%C3%A2ncia">Contextualiza√ß√£o e Import√¢ncia</h2>
<p>As falhas de identifica√ß√£o e autentica√ß√£o representam uma das vulnerabilidades mais exploradas em aplica√ß√µes web modernas. De acordo com dados do OWASP, esta categoria est√° associada a 22 CWEs (Common Weakness Enumerations), com taxa m√°xima de incid√™ncia de 14.84% e impacto m√©dio ponderado de 6.50<a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">^1</a>. A natureza cr√≠tica dessas falhas decorre de sua capacidade de permitir acesso n√£o autorizado a sistemas sens√≠veis, muitas vezes servindo como porta de entrada para viola√ß√µes de dados em larga escala.</p>
<p>A evolu√ß√£o dessa categoria reflete mudan√ßas no panorama de amea√ßas. Enquanto em vers√µes anteriores focava principalmente em senhas fracas e gest√£o inadequada de sess√µes, a edi√ß√£o de 2021 incorpora vulnerabilidades mais sofisticadas, como valida√ß√£o inadequada de certificados (CWE-297) e fixa√ß√£o de sess√£o (CWE-384)<a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">^2</a>. Essa expans√£o demonstra a necessidade de abordagens hol√≠sticas para seguran√ßa de autentica√ß√£o.</p>
<h3 id="mecanismos-subjacentes-%C3%A0s-vulnerabilidades">Mecanismos Subjacentes √†s Vulnerabilidades</h3>
<p>A raiz das falhas reside na implementa√ß√£o inadequada ou incompleta de controles de seguran√ßa essenciais:</p>
<ol>
<li><strong>Valida√ß√£o insuficiente de credenciais</strong>: Sistemas que n√£o implementam verifica√ß√µes robustas contra ataques automatizados como credential stuffing e for√ßa bruta<a href="https://trustpair.com/blog/credential-stuffing-attack/">^5</a>.</li>
<li><strong>Gest√£o fr√°gil de sess√µes</strong>: Pr√°ticas como exposi√ß√£o de identificadores de sess√£o na URL ou reutiliza√ß√£o de tokens ap√≥s login bem-sucedido<a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">^2</a>.</li>
<li><strong>Pol√≠ticas de senha inadequadas</strong>: Permiss√£o de senhas padr√£o, fracas ou conhecidas, combinada com falta de autentica√ß√£o multifator<a href="https://www.dio.me/articles/owasp-principais-vulnerabilidades-e-remediacoes-mapeadas">^1</a>.</li>
</ol>
<p>Um estudo de caso emblem√°tico ocorreu em 2021, quando o servi√ßo de streaming Roku sofreu um ataque de credential stuffing que comprometeu milhares de contas, resultando em transa√ß√µes n√£o autorizadas e vazamento de dados<a href="https://trustpair.com/blog/credential-stuffing-attack/">^7</a>. Esse incidente ilustra como falhas na autentica√ß√£o podem ter repercuss√µes financeiras e reputacionais significativas.</p>
<h2 id="principais-vetores-de-ataque">Principais Vetores de Ataque</h2>
<h3 id="credential-stuffing-e-for%C3%A7a-bruta">Credential Stuffing e For√ßa Bruta</h3>
<p>Ataques de credential stuffing utilizam listas massivas de credenciais vazadas em viola√ß√µes anteriores, testando-as automaticamente em m√∫ltiplos servi√ßos. A alta taxa de reutiliza√ß√£o de senhas entre usu√°rios (estimada em 65% pela Verizon DBIR 2023) torna essa t√©cnica particularmente eficaz<a href="https://trustpair.com/blog/credential-stuffing-attack/">^7</a>. Em 2021, um √∫nico ataque ao Roku demonstrou como milh√µes de credenciais podem ser testadas em escala industrial, aproveitando-se da falta de mecanismos de limita√ß√£o de tentativas<a href="https://trustpair.com/blog/credential-stuffing-attack/">^7</a>.</p>
<p>Ataques de for√ßa bruta, por sua vez, tentam combina√ß√µes aleat√≥rias de credenciais, muitas vezes usando dicion√°rios de senhas comuns. A aus√™ncia de pol√≠ticas que bloqueiem tentativas sequenciais ou implementem atrasos progressivos entre tentativas falhas facilita esses ataques<a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">^5</a>.</p>
<h3 id="gest%C3%A3o-inadequada-de-sess%C3%B5es">Gest√£o Inadequada de Sess√µes</h3>
<p>A fixa√ß√£o de sess√£o (CWE-384) ocorre quando um atacante for√ßa o uso de um ID de sess√£o espec√≠fico, geralmente atrav√©s de par√¢metros URL. Ap√≥s o usu√°rio autenticar-se com esse ID comprometido, o invasor assume o controle da sess√£o<a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">^2</a>. Outra vulnerabilidade comum √© a falta de invalida√ß√£o adequada de tokens ap√≥s logout ou per√≠odos de inatividade, permitindo que sess√µes permane√ßam ativas indefinidamente<a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">^1</a>.</p>
<h3 id="autentica%C3%A7%C3%A3o-multifator-mfa-ineficaz">Autentica√ß√£o Multifator (MFA) Ineficaz</h3>
<p>Apesar de amplamente recomendada, a implementa√ß√£o inadequada de MFA continua sendo um problema. Sistemas que permitem bypass de MFA atrav√©s de canais alternativos ou que n√£o aplicam verifica√ß√µes consistentes em todas as funcionalidades cr√≠ticas permanecem vulner√°veis<a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">^5</a>. A CWE-306 (Missing Authentication for Critical Function) destaca riscos em opera√ß√µes sens√≠veis realizadas sem verifica√ß√£o adequada<a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">^5</a>.</p>
<h2 id="impactos-operacionais-e-financeiros">Impactos Operacionais e Financeiros</h2>
<h3 id="comprometimento-de-dados-sens%C3%ADveis">Comprometimento de Dados Sens√≠veis</h3>
<p>Acesso n√£o autorizado a contas privilegiadas frequentemente resulta em exposi√ß√£o de informa√ß√µes pessoais identific√°veis (PII), dados financeiros e propriedade intelectual. Em sistemas de sa√∫de, isso pode levar a viola√ß√µes de registros m√©dicos protegidos pelo HIPAA, com multas que chegam a US$ 1,5 milh√£o por viola√ß√£o<a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">^1</a>.</p>
<h3 id="perdas-financeiras-diretas">Perdas Financeiras Diretas</h3>
<p>Contas comprometidas em sistemas de com√©rcio eletr√¥nico ou banc√°rios permitem transa√ß√µes fraudulentas. O Relat√≥rio de Amea√ßas Cibern√©ticas da IBM de 2023 estima o custo m√©dio de uma viola√ß√£o de dados em US$ 4,45 milh√µes, com ataques relacionados a credenciais representando 19% desse total<a href="https://trustpair.com/blog/credential-stuffing-attack/">^7</a>.</p>
<h3 id="danos-%C3%A0-reputa%C3%A7%C3%A3o-institucional">Danos √† Reputa√ß√£o Institucional</h3>
<p>A perda de confian√ßa do cliente ap√≥s viola√ß√µes de autentica√ß√£o pode ter impactos duradouros. Estudos do Ponemon Institute indicam que 31% dos consumidores abandonam servi√ßos ap√≥s incidentes de seguran√ßa, com preju√≠zos de marca dif√≠ceis de quantificar<a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">^5</a>.</p>
<h2 id="estrat%C3%A9gias-de-mitiga%C3%A7%C3%A3o-efetivas">Estrat√©gias de Mitiga√ß√£o Efetivas</h2>
<h3 id="implementa%C3%A7%C3%A3o-rigorosa-de-mfa">Implementa√ß√£o Rigorosa de MFA</h3>
<p>A autentica√ß√£o multifator baseada em fatores de posse (como tokens hardware) ou iner√™ncia (biometria) reduz drasticamente o risco de credential stuffing. O padr√£o NIST 800-63B recomenda a combina√ß√£o de pelo menos dois fatores independentes para opera√ß√µes cr√≠ticas<a href="https://trustpair.com/blog/credential-stuffing-attack/">^5</a>. Sistemas devem validar MFA em todas as camadas de acesso, incluindo APIs e microservi√ßos.</p>
<h3 id="pol%C3%ADticas-de-senha-baseadas-em-evid%C3%AAncias">Pol√≠ticas de Senha Baseadas em Evid√™ncias</h3>
<p>Contrariando pr√°ticas hist√≥ricas, o NIST recomenda:</p>
<ul>
<li>Eliminar requisitos de complexidade arbitr√°ria (como caracteres especiais obrigat√≥rios)</li>
<li>Permitir senhas longas (m√≠nimo de 8 caracteres, m√°ximo de 64)</li>
<li>Verifica√ß√£o contra listas de senhas comprometidas</li>
<li>Aboli√ß√£o de rota√ß√£o peri√≥dica for√ßada<a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">^5</a></li>
</ul>
<p>Ferramentas como Have I Been Pwned API permitem integra√ß√£o direta com sistemas de cadastro para bloquear senhas conhecidamente vazadas<a href="https://trustpair.com/blog/credential-stuffing-attack/">^7</a>.</p>
<h3 id="gest%C3%A3o-de-sess%C3%A3o-segura">Gest√£o de Sess√£o Segura</h3>
<p>Protocolos modernos exigem:</p>
<ul>
<li>Geradores de token criptograficamente seguros</li>
<li>Cookies de sess√£o com atributos Secure e HttpOnly</li>
<li>Invalida√ß√£o server-side imediata ap√≥s logout</li>
<li>Tempos de expira√ß√£o curtos (15-30 minutos de inatividade)</li>
<li>Renova√ß√£o de token ap√≥s eleva√ß√£o de privil√©gios<a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">^1</a></li>
</ul>
<p>A implementa√ß√£o de OAuth 2.1 e OpenID Connect oferece estruturas robustas para gest√£o de sess√µes e tokens, incorporando mecanismos como Proof Key for Code Exchange (PKCE) para prevenir ataques de intercepta√ß√£o<a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">^5</a>.</p>
<h3 id="monitoramento-e-resposta-a-incidentes">Monitoramento e Resposta a Incidentes</h3>
<p>Sistemas de detec√ß√£o devem incluir:</p>
<ul>
<li>An√°lise comportamental para identificar padr√µes de acesso an√¥malos</li>
<li>Limita√ß√£o de taxa (rate limiting) adaptativa baseada em risco</li>
<li>Integra√ß√£o com feeds de intelig√™ncia de amea√ßas para bloquear IPs maliciosos</li>
<li>Logs detalhados de autentica√ß√£o com reten√ß√£o m√≠nima de 90 dias<a href="https://trustpair.com/blog/credential-stuffing-attack/">^5</a></li>
</ul>
<p>Ferramentas como Elastic SIEM e Azure Sentinel permitem correla√ß√£o automatizada de eventos de login suspeitos, disparando respostas como desafios adicionais de autentica√ß√£o ou bloqueios tempor√°rios.</p>
<h2 id="casos-de-estudo-relevantes">Casos de Estudo Relevantes</h2>
<h3 id="ataque-ao-twilio-2022">Ataque ao Twilio (2022)</h3>
<p>Atacantes utilizaram credential stuffing para comprometer contas de funcion√°rios, acessando sistemas internos e dados de clientes. A falta de MFA obrigat√≥rio e monitoramento de padr√µes de login incomuns permitiu a escalada do ataque<a href="https://trustpair.com/blog/credential-stuffing-attack/">^7</a>.</p>
<h3 id="vulnerabilidade-no-microsoft-azure-ad-2023">Vulnerabilidade no Microsoft Azure AD (2023)</h3>
<p>Uma configura√ß√£o inadequada em fluxos de autentica√ß√£o OAuth permitiu bypass de MFA atrav√©s de endpoints legados. O incidente destacou a import√¢ncia de auditorias regulares em implementa√ß√µes de protocolos de autentica√ß√£o<a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">^5</a>.</p>
<h2 id="tend%C3%AAncias-emergentes-e-desafios-futuros">Tend√™ncias Emergentes e Desafios Futuros</h2>
<h3 id="autentica%C3%A7%C3%A3o-passwordless">Autentica√ß√£o Passwordless</h3>
<p>Tecnologias como FIDO2 e WebAuthn est√£o ganhando tra√ß√£o, substituindo senhas por chaves criptogr√°ficas armazenadas em dispositivos do usu√°rio. Embora promissoras, exigem mudan√ßas significativas na arquitetura de sistemas legados<a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">^5</a>.</p>
<h3 id="amea%C3%A7as-de-ia-generativa">Amea√ßas de IA Generativa</h3>
<p>Modelos de linguagem como GPT-4 demonstram capacidade de gerar ataques de phishing altamente personalizados, contornando sistemas tradicionais de detec√ß√£o. Isso exige aprimoramento cont√≠nuo de mecanismos de autentica√ß√£o adaptativa<a href="https://trustpair.com/blog/credential-stuffing-attack/">^7</a>.</p>
<h3 id="regulamenta%C3%A7%C3%B5es-globais">Regulamenta√ß√µes Globais</h3>
<p>Leis como a PCI DSS v4.0 e o Digital Operational Resilience Act (DORA) da UE imp√µem requisitos r√≠gidos para autentica√ß√£o em sistemas financeiros, incluindo testes anuais de resist√™ncia a ataques de credential stuffing<a href="https://trustpair.com/blog/credential-stuffing-attack/">^5</a>.</p>
<h2 id="conclus%C3%A3o">Conclus√£o</h2>
<p>As falhas de identifica√ß√£o e autentica√ß√£o permanecem entre as vulnerabilidades mais cr√≠ticas na seguran√ßa cibern√©tica contempor√¢nea. A complexidade crescente dos ecossistemas digitais, combinada com t√°ticas de ataque cada vez mais sofisticadas, exige abordagens multilayered para mitiga√ß√£o.</p>
<p>Organiza√ß√µes devem adotar frameworks como o OWASP Application Security Verification Standard (ASVS) para auditoria cont√≠nua de seus mecanismos de autentica√ß√£o<a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">^5</a>. A combina√ß√£o de controles t√©cnicos avan√ßados (MFA, biometrics, behavioral analytics) com pol√≠ticas organizacionais robustas (treinamento de usu√°rios, gest√£o de identidades privilegiadas) forma a base para sistemas resilientes.</p>
<p>O cen√°rio evolutivo das amea√ßas requer vigil√¢ncia constante. Investimentos em intelig√™ncia artificial para detec√ß√£o de anomalias, ado√ß√£o de padr√µes passwordless e integra√ß√£o profunda com ecossistemas de threat intelligence surgem como imperativos estrat√©gicos para seguran√ßa sustent√°vel no longo prazo<a href="https://trustpair.com/blog/credential-stuffing-attack/">^7</a>.</p>
<div style="text-align: center">‚ÅÇ</div>

</body>
</html>
